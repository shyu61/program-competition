#include <bits/stdc++.h>
using namespace std;
#define rep(i, n) for (int i = 0; i < (n); i++)

// æœ¨ã®å®šç¾©
// - ç„¡å‘æœ¨: é€£çµã§é–‰è·¯ãŒãªã„
//   - né ‚ç‚¹ãªã‚‰è¾ºã¯n-1æœ¬
//   - ä»»æ„ã®2ç‚¹é–“ã®ãƒ‘ã‚¹ãŒä¸€æ„ã«æ±ºã¾ã‚‹
// - æœ‰å‘æœ¨: é–‰è·¯ãŒå­˜åœ¨ã›ãšã€1ã¤ã®æ ¹(å…¥æ¬¡æ•°=0)ã¨ãã®ä»–é ‚ç‚¹(å…¥æ¬¡æ•°=1)ã‹ã‚‰æˆã‚‹
//   - né ‚ç‚¹ãªã‚‰è¾ºã¯n-1æœ¬
//   - æ ¹ã¨ä»»æ„ã®1ç‚¹é–“ã®ãƒ‘ã‚¹ãŒä¸€æ„ã«æ±ºã¾ã‚‹
// - ç›´å¾„ã«é–¢ã™ã‚‹æ€§è³ªã¯ç„¡å‘æœ¨ã®ã¿ã«å½“ã¦ã¯ã¾ã‚‹

// ðŸ”·æŠ‘ãˆã‚‹ã¹ãæŠ½è±¡è«–ã¯ï¼Ÿ
// dagã§dpã—ãŸã„æ™‚ã¯ãƒˆãƒãƒ­ã‚¸ã‚«ãƒ«ã‚½ãƒ¼ãƒˆã¨ã‚»ãƒƒãƒˆã§è€ƒãˆã‚‹
// é·ç§»é †ãŒä¸æ˜Žç¢ºãªå ´åˆã¯ãƒ¡ãƒ¢åŒ–å†å¸°ãŒæœ‰åŠ¹
// æœ¨dpã‚’æ¤œè¨Žã™ã¹ãã‚·ãƒ¼ãƒ³
// - å„é ‚ç‚¹ã§ãªã‚“ã‚‰ã‹ã®é›†è¨ˆå€¤ã‚’è¨ˆç®—ã—ãŸã„æ™‚

int main() {
    int n, m; cin >> n >> m;
    vector<vector<int>> g(n);
    rep(i, m) {
        int u, v; cin >> u >> v;
        u--, v--;
        g[u].push_back(v);
    }

    vector<int> dp(n, -1);
    auto rec = [&](auto rec, int v) -> int {
        if (dp[v] != -1) return dp[v];
        int res = 0;
        for (auto u : g[v]) {
            res = max(res, rec(rec, u) + 1);
        }
        return dp[v] = res;
    };

    int ans = 0;
    rep(i, n) ans = max(ans, rec(rec, i));
    cout << ans << endl;
}
